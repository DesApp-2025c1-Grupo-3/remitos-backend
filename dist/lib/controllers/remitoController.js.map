{"version":3,"sources":["../../../lib/controllers/remitoController.js"],"names":["includes","require","Remito","Cliente","Destino","Contacto","Estado","message","controller","getRemitos","req","res","remitos","findAll","include","model","as","status","json","getRemitoById","id","params","remito","findByPk","createRemito","numeroAsignado","tipoMercaderia","valorDeclarado","volumenMetrosCubico","pesoMercaderia","cantidadBobinas","cantidadRacks","cantidadBultos","cantidadPallets","requisitosEspeciales","observaciones","archivoAdjunto","body","fechaEmision","Date","create","createRemitoWithClienteAndDestino","clienteId","destinoId","estadoId","remitoWithDestinoAndCliente","updateRemito","idRemito","update","updateEstadoRemito","remitoId","estId","eid","remitoActualizado","deleteRemito","destroy","module","exports"],"mappings":"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","sourcesContent":["const { includes } = require(\"lodash\");\r\nconst { Remito, Cliente, Destino, Contacto, Estado } = require(\"../models\");\r\nconst { message } = require(\"../schemas/estadoSchema\");\r\nconst controller = {};\r\n\r\nconst getRemitos = async (req, res) => {\r\n  const remitos = await Remito.findAll({\r\n    include: [\r\n      {\r\n        model: Destino,\r\n        as: \"destino\",\r\n      },\r\n      {\r\n        model: Cliente,\r\n        as: \"cliente\",\r\n      },\r\n      {\r\n        model: Estado,\r\n        as: \"estado\"\r\n      }\r\n    ],\r\n  });\r\n  res.status(200).json(remitos);\r\n};\r\ncontroller.getRemitos = getRemitos;\r\n\r\nconst getRemitoById = async (req, res) => {\r\n  const id = req.params.id;\r\n  const remito = await Remito.findByPk(id, {\r\n    include: [\r\n      {\r\n        model: Destino,\r\n        as: \"destino\",\r\n      },\r\n      {\r\n        model: Cliente,\r\n        as: \"cliente\",\r\n      },\r\n      {\r\n        model: Estado,\r\n        as: \"estado\"\r\n      }\r\n    ],\r\n  });\r\n  res.status(200).json(remito);\r\n};\r\ncontroller.getRemitoById = getRemitoById;\r\n\r\nconst createRemito = async (req, res) => {\r\n  const {\r\n    numeroAsignado,\r\n    tipoMercaderia,\r\n    valorDeclarado,\r\n    volumenMetrosCubico,\r\n    pesoMercaderia,\r\n    cantidadBobinas,\r\n    cantidadRacks,\r\n    cantidadBultos,\r\n    cantidadPallets,\r\n    requisitosEspeciales,\r\n    observaciones,\r\n    archivoAdjunto,\r\n  } = req.body;\r\n  const fechaEmision = new Date();\r\n  const remito = await Remito.create({\r\n    numeroAsignado,\r\n    tipoMercaderia,\r\n    valorDeclarado,\r\n    volumenMetrosCubico,\r\n    pesoMercaderia,\r\n    fechaEmision,\r\n    cantidadBobinas,\r\n    cantidadRacks,\r\n    cantidadBultos,\r\n    cantidadPallets,\r\n    requisitosEspeciales,\r\n    observaciones,\r\n    archivoAdjunto,\r\n  });\r\n  res.status(201).json(remito);\r\n};\r\ncontroller.createRemito = createRemito;\r\n\r\nconst createRemitoWithClienteAndDestino = async (req, res) => {\r\n  const {\r\n    numeroAsignado,\r\n    tipoMercaderia,\r\n    valorDeclarado,\r\n    volumenMetrosCubico,\r\n    pesoMercaderia,\r\n    cantidadBobinas,\r\n    cantidadRacks,\r\n    cantidadBultos,\r\n    cantidadPallets,\r\n    requisitosEspeciales,\r\n    observaciones,\r\n    archivoAdjunto,\r\n    clienteId,\r\n    destinoId\r\n  } = req.body;\r\n  const fechaEmision = new Date();\r\n  const remito = await Remito.create({\r\n    numeroAsignado,\r\n    tipoMercaderia,\r\n    valorDeclarado,\r\n    volumenMetrosCubico,\r\n    pesoMercaderia,\r\n    fechaEmision,\r\n    cantidadBobinas,\r\n    cantidadRacks,\r\n    cantidadBultos,\r\n    cantidadPallets,\r\n    requisitosEspeciales,\r\n    observaciones,\r\n    archivoAdjunto,\r\n    clienteId,\r\n    destinoId,\r\n    estadoId:1\r\n  });\r\n  const remitoWithDestinoAndCliente = await Remito.findByPk(remito.id, {\r\n    include: [\r\n      {\r\n        model: Destino,\r\n        as: \"destino\",\r\n      },\r\n      {\r\n        model: Cliente,\r\n        as: \"cliente\",\r\n      },\r\n    ],\r\n  });\r\n  res.status(201).json(remitoWithDestinoAndCliente);\r\n};\r\ncontroller.createRemitoWithClienteAndDestino = createRemitoWithClienteAndDestino;\r\n\r\nconst updateRemito = async (req, res) => {\r\n  const idRemito = req.params.id;\r\n  const {\r\n    numeroAsignado,\r\n    tipoMercaderia,\r\n    valorDeclarado,\r\n    volumenMetrosCubico,\r\n    pesoMercaderia,\r\n    fechaEmision,\r\n    cantidadBobinas,\r\n    cantidadRacks,\r\n    cantidadBultos,\r\n    cantidadPallets,\r\n    requisitosEspeciales,\r\n    observaciones,\r\n    archivoAdjunto,\r\n  } = req.body;\r\n  const remito = await Remito.findByPk(idRemito);\r\n  await remito.update({\r\n    numeroAsignado,\r\n    tipoMercaderia,\r\n    valorDeclarado,\r\n    volumenMetrosCubico,\r\n    pesoMercaderia,\r\n    fechaEmision,\r\n    cantidadBobinas,\r\n    cantidadRacks,\r\n    cantidadBultos,\r\n    cantidadPallets,\r\n    requisitosEspeciales,\r\n    observaciones,\r\n    archivoAdjunto,\r\n  });\r\n  res.status(200).json(remito);\r\n};\r\ncontroller.updateRemito = updateRemito;\r\n\r\nconst updateEstadoRemito = async(req,res)=>{\r\n  const remitoId = req.params.id\r\n  const estId = req.params.eid\r\n  const remito = await Remito.findByPk(remitoId)\r\n  await remito.update({estadoId : estId})\r\n  const remitoActualizado = await Remito.findByPk(remitoId,{\r\n    include:[{\r\n      model: Cliente,\r\n      as: \"cliente\"\r\n    },\r\n    {\r\n      model: Destino,\r\n      as : \"destino\"\r\n    },\r\n    {\r\n      model: Estado,\r\n      as: \"estado\"\r\n    }\r\n  ]\r\n  })\r\n  res.status(200).json(remitoActualizado)\r\n}\r\ncontroller.updateEstadoRemito = updateEstadoRemito\r\n\r\nconst deleteRemito = async (req, res) => {\r\n  const id = req.params.id;\r\n  const remito = await Remito.findByPk(id);\r\n  await remito.destroy();\r\n  res.status(200).json({ message: \"Remito eliminado correctamente\" });\r\n};\r\ncontroller.deleteRemito = deleteRemito;\r\n\r\nmodule.exports = controller;\r\n"],"file":"remitoController.js"}