{"version":3,"sources":["../../../lib/controllers/remitoController.js"],"names":["includes","require","Remito","Cliente","Destino","Contacto","Estado","message","controller","getRemitos","req","res","remitos","findAll","include","model","as","status","json","getRemitoById","id","params","remito","findByPk","createRemito","numeroAsignado","tipoMercaderia","valorDeclarado","volumenMetrosCubico","pesoMercaderia","cantidadBobinas","cantidadRacks","cantidadBultos","cantidadPallets","requisitosEspeciales","observaciones","body","fechaEmision","Date","archivoEnviado","file","path","create","archivoAdjunto","createRemitoWithClienteAndDestino","clienteId","destinoId","estadoId","remitoWithDestinoAndCliente","updateRemito","idRemito","update","updateEstadoRemito","remitoId","estId","eid","remitoActualizado","deleteRemito","destroy","module","exports"],"mappings":"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","sourcesContent":["const { includes } = require(\"lodash\");\nconst { Remito, Cliente, Destino, Contacto, Estado } = require(\"../models\");\nconst { message } = require(\"../schemas/estadoSchema\");\nconst controller = {};\n\nconst getRemitos = async (req, res) => {\n  const remitos = await Remito.findAll({\n    include: [\n      {\n        model: Destino,\n        as: \"destino\",\n      },\n      {\n        model: Cliente,\n        as: \"cliente\",\n      },\n      {\n        model: Estado,\n        as: \"estado\",\n      },\n    ],\n  });\n  res.status(200).json(remitos);\n};\ncontroller.getRemitos = getRemitos;\n\nconst getRemitoById = async (req, res) => {\n  const id = req.params.id;\n  const remito = await Remito.findByPk(id, {\n    include: [\n      {\n        model: Destino,\n        as: \"destino\",\n      },\n      {\n        model: Cliente,\n        as: \"cliente\",\n      },\n      {\n        model: Estado,\n        as: \"estado\",\n      },\n    ],\n  });\n  res.status(200).json(remito);\n};\ncontroller.getRemitoById = getRemitoById;\n\nconst createRemito = async (req, res) => {\n  const {\n    numeroAsignado,\n    tipoMercaderia,\n    valorDeclarado,\n    volumenMetrosCubico,\n    pesoMercaderia,\n    cantidadBobinas,\n    cantidadRacks,\n    cantidadBultos,\n    cantidadPallets,\n    requisitosEspeciales,\n    observaciones,\n  } = req.body;\n  const fechaEmision = new Date();\n  const archivoEnviado = req.file?.path || null;\n  const remito = await Remito.create({\n    numeroAsignado,\n    tipoMercaderia,\n    valorDeclarado,\n    volumenMetrosCubico,\n    pesoMercaderia,\n    fechaEmision,\n    cantidadBobinas,\n    cantidadRacks,\n    cantidadBultos,\n    cantidadPallets,\n    requisitosEspeciales,\n    observaciones,\n    archivoAdjunto: archivoEnviado,\n  });\n  res.status(201).json(remito);\n};\ncontroller.createRemito = createRemito;\n\nconst createRemitoWithClienteAndDestino = async (req, res) => {\n  const {\n    numeroAsignado,\n    tipoMercaderia,\n    valorDeclarado,\n    volumenMetrosCubico,\n    pesoMercaderia,\n    cantidadBobinas,\n    cantidadRacks,\n    cantidadBultos,\n    cantidadPallets,\n    requisitosEspeciales,\n    observaciones,\n    clienteId,\n    destinoId,\n  } = req.body;\n  const archivoEnviado = req.file?.path || null;\n  const fechaEmision = new Date();\n  const remito = await Remito.create({\n    numeroAsignado,\n    tipoMercaderia,\n    valorDeclarado,\n    volumenMetrosCubico,\n    pesoMercaderia,\n    fechaEmision,\n    cantidadBobinas,\n    cantidadRacks,\n    cantidadBultos,\n    cantidadPallets,\n    requisitosEspeciales,\n    observaciones,\n    archivoAdjunto: archivoEnviado,\n    clienteId,\n    destinoId,\n    estadoId: 1,\n  });\n  const remitoWithDestinoAndCliente = await Remito.findByPk(remito.id, {\n    include: [\n      {\n        model: Destino,\n        as: \"destino\",\n      },\n      {\n        model: Cliente,\n        as: \"cliente\",\n      },\n    ],\n  });\n  res.status(201).json(remitoWithDestinoAndCliente);\n};\ncontroller.createRemitoWithClienteAndDestino = createRemitoWithClienteAndDestino;\n\nconst updateRemito = async (req, res) => {\n  const idRemito = req.params.id;\n  const {\n    numeroAsignado,\n    tipoMercaderia,\n    valorDeclarado,\n    volumenMetrosCubico,\n    pesoMercaderia,\n    fechaEmision,\n    cantidadBobinas,\n    cantidadRacks,\n    cantidadBultos,\n    cantidadPallets,\n    requisitosEspeciales,\n    observaciones,\n    archivoAdjunto,\n  } = req.body;\n  const remito = await Remito.findByPk(idRemito);\n  await remito.update({\n    numeroAsignado,\n    tipoMercaderia,\n    valorDeclarado,\n    volumenMetrosCubico,\n    pesoMercaderia,\n    fechaEmision,\n    cantidadBobinas,\n    cantidadRacks,\n    cantidadBultos,\n    cantidadPallets,\n    requisitosEspeciales,\n    observaciones,\n    archivoAdjunto,\n  });\n  res.status(200).json(remito);\n};\ncontroller.updateRemito = updateRemito;\n\nconst updateEstadoRemito = async (req, res) => {\n  const remitoId = req.params.id;\n  const estId = req.params.eid;\n  const remito = await Remito.findByPk(remitoId);\n  await remito.update({ estadoId: estId });\n  const remitoActualizado = await Remito.findByPk(remitoId, {\n    include: [\n      {\n        model: Cliente,\n        as: \"cliente\",\n      },\n      {\n        model: Destino,\n        as: \"destino\",\n      },\n      {\n        model: Estado,\n        as: \"estado\",\n      },\n    ],\n  });\n  res.status(200).json(remitoActualizado);\n};\ncontroller.updateEstadoRemito = updateEstadoRemito;\n\nconst deleteRemito = async (req, res) => {\n  const id = req.params.id;\n  const remito = await Remito.findByPk(id);\n  await remito.destroy();\n  res.status(200).json({ message: \"Remito eliminado correctamente\" });\n};\ncontroller.deleteRemito = deleteRemito;\n\nmodule.exports = controller;\n"],"file":"remitoController.js"}