{"version":3,"sources":["../../../lib/controllers/contactoController.js"],"names":["where","require","Contacto","Cliente","Destino","message","controller","getContacto","req","res","contactos","findAll","activo","include","model","as","status","json","getContactoById","id","params","contacto","findByPk","createContacto","body","nuevoContacto","create","updateContacto","personaAutoriza","correoElectronico","telefono","update","deleteContacto","contactoId","module","exports"],"mappings":"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","sourcesContent":["const { where } = require(\"sequelize\");\r\nconst { Contacto, Cliente, Destino } = require(\"../models\");\r\nconst { message } = require(\"../schemas/estadoSchema\");\r\nconst controller = {};\r\n\r\nconst getContacto = async (req, res) => {\r\n  const contactos = await Contacto.findAll({\r\n    where: { activo: true }, // Solo trae contactos activos\r\n    include: {\r\n      model: Cliente,\r\n      as: \"cliente\",\r\n    },\r\n  });\r\n  res.status(200).json(contactos);\r\n};\r\ncontroller.getContacto = getContacto;\r\n\r\nconst getContactoById = async (req, res) => {\r\n  const id = req.params.id;\r\n  const contacto = await Contacto.findByPk(id, {\r\n    include: [\r\n      {\r\n        model: Cliente,\r\n        as: \"cliente\",\r\n      },\r\n      {\r\n        model: Destino,\r\n        as: \"destino\",\r\n      },\r\n    ],\r\n  });\r\n  res.status(200).json(contacto);\r\n};\r\ncontroller.getContactoById = getContactoById;\r\n\r\nconst createContacto = async (req, res) => {\r\n  const contacto = req.body;\r\n  const nuevoContacto = await Contacto.create(contacto);\r\n  res.status(201).json(nuevoContacto);\r\n};\r\ncontroller.createContacto = createContacto;\r\n\r\nconst updateContacto = async (req, res) => {\r\n  const id = req.params.id;\r\n  const { personaAutoriza, correoElectronico, telefono } = req.body;\r\n  const contacto = await Contacto.findByPk(id);\r\n  await contacto.update({ personaAutoriza, correoElectronico, telefono });\r\n  res.status(200).json(contacto);\r\n};\r\ncontroller.updateContacto = updateContacto;\r\n\r\n// Se elimina el contacto marcándolo como inactivo, no se elimina de la base de datos.\r\nconst deleteContacto = async (req, res) => {\r\n  const contactoId = req.params.id;\r\n  const contacto = await Contacto.findByPk(contactoId);\r\n  await contacto.update({ activo: false });\r\n  res.status(200).json({ message: \"Contacto eliminado.\" });\r\n}\r\ncontroller.deleteContacto = deleteContacto;\r\n\r\n/* // Si se quiere eliminar de la base de datos, se puede usar este método\r\n   //  pero es mejor usar un campo activo para no perder el historial de contactos.\r\nconst deleteContacto = async (req, res) => {\r\n  const idContacto = req.params.id;\r\n  const contacto = await Contacto.destroy({ where: { id: idContacto } });\r\n  res.status(200).json({ message: \"Contacto eliminado correctamente\" });\r\n};\r\ncontroller.deleteContacto = deleteContacto;\r\n*/\r\n\r\nmodule.exports = controller;\r\n"],"file":"contactoController.js"}