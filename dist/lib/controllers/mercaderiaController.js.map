{"version":3,"sources":["../../../lib/controllers/mercaderiaController.js"],"names":["includes","require","Remito","Estado","Mercaderia","TipoMercaderia","message","where","controller","getMercaderia","req","res","mercaderias","findAll","include","model","as","status","json","getMercaderiaById","id","params","mercaderia","updateMercaderia","tipoMercaderia","valorDeclarado","volumenMetrosCubico","pesoMercaderia","cantidadBobinas","cantidadRacks","cantidadBultos","cantidadPallets","requisitosEspeciales","activo","remitosId","estadoId","body","idMercaderia","findByPk","update","createMercaderia","tipo","tipoMercaderiaId","error","create","deleteMercaderia","mercaderiaId","module","exports"],"mappings":"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","sourcesContent":["const { includes } = require(\"lodash\");\r\nconst { Remito, Estado, Mercaderia, TipoMercaderia } = require(\"../models\");\r\nconst { message } = require(\"../schemas/estadoSchema\");\r\nconst { where } = require(\"sequelize\");\r\nconst controller = {};\r\n\r\nconst getMercaderia = async (req, res) => {\r\n  const mercaderias = await Mercaderia.findAll({\r\n    include: [{ model: TipoMercaderia, as: \"tipoMercaderia\" }],\r\n  });\r\n\r\n  res.status(200).json(mercaderias);\r\n};\r\ncontroller.getMercaderia = getMercaderia;\r\n\r\nconst getMercaderiaById = async (req, res) => {\r\n  const id = req.params.id;\r\n  const mercaderia = await Mercaderia.findAll(id, {\r\n    include: { model: Estado, as: \"estado\" },\r\n  });\r\n  res.status(200).json(mercaderia);\r\n}; //Consultar si se muestran los eliminados con activo = false\r\ncontroller.getMercaderiaById = getMercaderiaById;\r\n\r\nconst updateMercaderia = async (req, res) => {\r\n  const {\r\n    tipoMercaderia,\r\n    valorDeclarado,\r\n    volumenMetrosCubico,\r\n    pesoMercaderia,\r\n    cantidadBobinas,\r\n    cantidadRacks,\r\n    cantidadBultos,\r\n    cantidadPallets,\r\n    requisitosEspeciales,\r\n    activo,\r\n    remitosId,\r\n    estadoId,\r\n  } = req.body;\r\n  const idMercaderia = req.params.id;\r\n  const mercaderia = await Mercaderia.findByPk(idMercaderia);\r\n  await mercaderia.update({\r\n    tipoMercaderia,\r\n    valorDeclarado,\r\n    volumenMetrosCubico,\r\n    pesoMercaderia,\r\n    cantidadBobinas,\r\n    cantidadRacks,\r\n    cantidadBultos,\r\n    cantidadPallets,\r\n    requisitosEspeciales,\r\n    activo,\r\n    remitosId,\r\n    estadoId,\r\n  });\r\n  res.status(200).json(mercaderia);\r\n};\r\ncontroller.updateMercaderia = updateMercaderia;\r\n\r\nconst createMercaderia = async (req, res) => {\r\n  const {\r\n    tipoMercaderia,\r\n    valorDeclarado,\r\n    volumenMetrosCubico,\r\n    pesoMercaderia,\r\n    cantidadBobinas,\r\n    cantidadRacks,\r\n    cantidadBultos,\r\n    cantidadPallets,\r\n    requisitosEspeciales,\r\n    activo,\r\n    remitosId,\r\n    estadoId,\r\n  } = req.body;\r\n  const tipo = await TipoMercaderia.findByPk(req.body.tipoMercaderiaId);\r\n  if (!tipo) {\r\n    return res.status(400).json({ error: \"Tipo de mercadería no válido\" });\r\n  }\r\n  const mercaderia = await Mercaderia.create({ ...req.body });\r\n  res.status(201).json(mercaderia);\r\n};\r\ncontroller.createMercaderia = createMercaderia;\r\n\r\nconst deleteMercaderia = async (req, res) => {\r\n  const mercaderiaId = req.params.id;\r\n  const mercaderia = await Mercaderia.findByPk(mercaderiaId);\r\n  await mercaderia.update({ activo: false });\r\n  res.status(200).json({ message: \"Mercaderia eliminada.\" });\r\n};\r\ncontroller.deleteMercaderia = deleteMercaderia;\r\n\r\nmodule.exports = controller;\r\n"],"file":"mercaderiaController.js"}