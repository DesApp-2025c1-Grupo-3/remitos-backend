{"version":3,"sources":["../../../lib/config/config.js"],"names":["path","require","debug","parse","dotenv","getEnvironment","process","env","NODE_ENV","initializeEnv","config","resolve","cwd","parseHerokuUrlIfPresent","url","DATABASE_URL","undefined","username","user","native","normalizePort","val","portNum","parseInt","Number","isNaN","initializeConfig","environment","dbConfig","SQL_USERNAME","password","SQL_PASSWORD","database","SQL_DATABASE","host","SQL_HOST","port","SQL_PORT","dialect","logging","SQL_DATABASE_SCHEMA","schema","seederStorage","SQL_TEST_DATABASE","db","PORT","module","exports"],"mappings":"AAAA,MAAMA,IAAI,GAAGC,OAAO,CAAC,MAAD,CAApB;;AACA,MAAMC,KAAK,GAAGD,OAAO,CAAC,OAAD,CAArB;;AACA,MAAME,KAAK,GAAGF,OAAO,CAAC,sBAAD,CAAP,CAAgCE,KAA9C;;AACA,MAAMC,MAAM,GAAGH,OAAO,CAAC,QAAD,CAAtB;;AAEA,SAASI,cAAT,GAA0B;AACxB,SAAOC,OAAO,CAACC,GAAR,CAAYC,QAAZ,IAAwB,aAA/B;AACD;;AAED,SAASC,aAAT,GAAyB;AACvBL,EAAAA,MAAM,CAACM,MAAP,CAAc;AACZV,IAAAA,IAAI,EAAEA,IAAI,CAACW,OAAL,CAAaL,OAAO,CAACM,GAAR,EAAb,EAA6B,QAAOP,cAAc,EAAG,EAArD;AADM,GAAd;AAGD;;AAED,SAASQ,uBAAT,GAAmC;AACjC,QAAMC,GAAG,GAAGR,OAAO,CAACC,GAAR,CAAYQ,YAAxB;;AAEA,MAAID,GAAG,KAAKE,SAAZ,EAAuB;AACrB,WAAO,EAAP;AACD;;AAED,QAAMN,MAAM,GAAGP,KAAK,CAACW,GAAD,CAApB,CAPiC,CASjC;;AACA,SAAO,EACL,GAAGJ,MADE;AAELO,IAAAA,QAAQ,EAAEP,MAAM,CAACQ,IAFZ;AAGLC,IAAAA,MAAM,EAAE;AAHH,GAAP;AAKD;;AAED,SAASC,aAAT,CAAuBC,GAAvB,EAA4B;AAC1B,QAAMC,OAAO,GAAGC,QAAQ,CAACF,GAAD,EAAM,EAAN,CAAxB;;AAEA,MAAIG,MAAM,CAACC,KAAP,CAAaH,OAAb,CAAJ,EAA2B;AACzB;AACA,WAAOD,GAAP;AACD;;AAED,MAAIC,OAAO,IAAI,CAAf,EAAkB;AAChB;AACA,WAAOA,OAAP;AACD;;AAED,SAAO,KAAP;AACD;;AAED,SAASI,gBAAT,GAA4B;AAC1B,QAAMC,WAAW,GAAGtB,cAAc,EAAlC;AACA,MAAIuB,QAAQ,GAAG;AACbX,IAAAA,QAAQ,EAAEX,OAAO,CAACC,GAAR,CAAYsB,YAAZ,IAA4B,UADzB;AAEbC,IAAAA,QAAQ,EAAExB,OAAO,CAACC,GAAR,CAAYwB,YAAZ,IAA4B,MAFzB;AAGbC,IAAAA,QAAQ,EAAE1B,OAAO,CAACC,GAAR,CAAY0B,YAAZ,IAA4B,QAHzB;AAIbC,IAAAA,IAAI,EAAE5B,OAAO,CAACC,GAAR,CAAY4B,QAAZ,IAAwB,WAJjB;AAKbC,IAAAA,IAAI,EAAE9B,OAAO,CAACC,GAAR,CAAY8B,QAAZ,IAAwB,MALjB;AAMbC,IAAAA,OAAO,EAAE,UANI;AAObC,IAAAA,OAAO,EAAE;AAPI,GAAf;;AASA,MAAIjC,OAAO,CAACC,GAAR,CAAYiC,mBAAhB,EAAqC;AACnCZ,IAAAA,QAAQ,CAACa,MAAT,GAAkBnC,OAAO,CAACC,GAAR,CAAYiC,mBAA9B;AACD;;AACD,MAAIb,WAAW,KAAK,aAApB,EAAmC;AACjCC,IAAAA,QAAQ,CAACc,aAAT,GAAyB,WAAzB;AACD,GAFD,MAEO,IAAIf,WAAW,KAAK,MAApB,EAA4B;AACjCC,IAAAA,QAAQ,CAACI,QAAT,GACE1B,OAAO,CAACC,GAAR,CAAYoC,iBAAZ,IAAiCrC,OAAO,CAACC,GAAR,CAAY0B,YAD/C;AAED,GAHM,MAGA,IAAIN,WAAW,KAAK,YAApB,EAAkC;AACvCC,IAAAA,QAAQ,GAAG,EAAE,GAAGA,QAAL;AAAe,SAAGf,uBAAuB;AAAzC,KAAX;AACD;;AACD,SAAO;AACL+B,IAAAA,EAAE,EAAEhB,QADC;AAELQ,IAAAA,IAAI,EAAEhB,aAAa,CAACd,OAAO,CAACC,GAAR,CAAYsC,IAAZ,IAAoB,MAArB;AAFd,GAAP;AAID;;AAEDpC,aAAa;AAEbqC,MAAM,CAACC,OAAP,GAAiBrB,gBAAgB,EAAjC","sourcesContent":["const path = require(\"path\");\nconst debug = require(\"debug\");\nconst parse = require(\"pg-connection-string\").parse;\nconst dotenv = require(\"dotenv\");\n\nfunction getEnvironment() {\n  return process.env.NODE_ENV || \"development\";\n}\n\nfunction initializeEnv() {\n  dotenv.config({\n    path: path.resolve(process.cwd(), `.env.${getEnvironment()}`),\n  });\n}\n\nfunction parseHerokuUrlIfPresent() {\n  const url = process.env.DATABASE_URL;\n\n  if (url === undefined) {\n    return {};\n  }\n\n  const config = parse(url);\n\n  // Heroku necesita sí o sí SSL, y para eso hay que habilitar el driver nativo.\n  return {\n    ...config,\n    username: config.user,\n    native: true,\n  };\n}\n\nfunction normalizePort(val) {\n  const portNum = parseInt(val, 10);\n\n  if (Number.isNaN(portNum)) {\n    // named pipe\n    return val;\n  }\n\n  if (portNum >= 0) {\n    // port number\n    return portNum;\n  }\n\n  return false;\n}\n\nfunction initializeConfig() {\n  const environment = getEnvironment();\n  let dbConfig = {\n    username: process.env.SQL_USERNAME || \"postgres\",\n    password: process.env.SQL_PASSWORD || \"1234\",\n    database: process.env.SQL_DATABASE || \"desapp\",\n    host: process.env.SQL_HOST || \"localhost\",\n    port: process.env.SQL_PORT || \"5432\",\n    dialect: \"postgres\",\n    logging: false,\n  };\n  if (process.env.SQL_DATABASE_SCHEMA) {\n    dbConfig.schema = process.env.SQL_DATABASE_SCHEMA;\n  }\n  if (environment === \"development\") {\n    dbConfig.seederStorage = \"sequelize\";\n  } else if (environment === \"test\") {\n    dbConfig.database =\n      process.env.SQL_TEST_DATABASE || process.env.SQL_DATABASE;\n  } else if (environment === \"production\") {\n    dbConfig = { ...dbConfig, ...parseHerokuUrlIfPresent() };\n  }\n  return {\n    db: dbConfig,\n    port: normalizePort(process.env.PORT || \"3001\"),\n  };\n}\n\ninitializeEnv();\n\nmodule.exports = initializeConfig();\n"],"file":"config.js"}