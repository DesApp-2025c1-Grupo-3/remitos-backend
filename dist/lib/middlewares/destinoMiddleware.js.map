{"version":3,"sources":["../../../lib/middlewares/destinoMiddleware.js"],"names":["Destino","require","middleware","validateDestinoId","req","res","next","destinoId","params","id","destino","findByPk","activo","status","json","message","validarFiltroDestino","name","pais","provincia","localidad","query","soloLetras","campo","valor","Object","entries","test","length","error","module","exports"],"mappings":"AAAA,MAAM;AAAEA,EAAAA;AAAF,IAAcC,OAAO,CAAC,WAAD,CAA3B;;AACA,MAAMC,UAAU,GAAG,EAAnB;;AAEA,MAAMC,iBAAiB,GAAG,OAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB,KAA0B;AAClD,QAAMC,SAAS,GAAGH,GAAG,CAACI,MAAJ,CAAWC,EAA7B;AACA,QAAMC,OAAO,GAAG,MAAMV,OAAO,CAACW,QAAR,CAAiBJ,SAAjB,CAAtB;;AACA,MAAI,CAACG,OAAD,IAAY,CAACA,OAAO,CAACE,MAAzB,EAAiC;AAC/B,WAAOP,GAAG,CAACQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,MAAAA,OAAO,EAAG,oBAAmBR,SAAU;AAAzC,KAArB,CAAP;AACD;;AACDD,EAAAA,IAAI;AACL,CAPD;;AAQAJ,UAAU,CAACC,iBAAX,GAA+BA,iBAA/B;;AAEA,MAAMa,oBAAoB,GAAG,CAACZ,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;AAC/C,QAAM;AAAEW,IAAAA,IAAF;AAAQC,IAAAA,IAAR;AAAcC,IAAAA,SAAd;AAAyBC,IAAAA;AAAzB,MAAuChB,GAAG,CAACiB,KAAjD;AACA,QAAMC,UAAU,GAAG,2BAAnB;;AACA,OAAK,MAAM,CAACC,KAAD,EAAQC,KAAR,CAAX,IAA6BC,MAAM,CAACC,OAAP,CAAe;AAAET,IAAAA,IAAF;AAAQC,IAAAA,IAAR;AAAcC,IAAAA,SAAd;AAAyBC,IAAAA;AAAzB,GAAf,CAA7B,EAAmF;AACjF,QAAII,KAAK,KAAK,CAACF,UAAU,CAACK,IAAX,CAAgBH,KAAhB,CAAD,IAA2BA,KAAK,CAACI,MAAN,GAAe,GAA/C,CAAT,EAA8D;AAC5D,aAAOvB,GAAG,CAACQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1Be,QAAAA,KAAK,EAAG,2BAA0BN,KAAM;AADd,OAArB,CAAP;AAGD;AACF;;AACDjB,EAAAA,IAAI;AACL,CAXD;;AAaAJ,UAAU,CAACc,oBAAX,GAAkCA,oBAAlC;AAEAc,MAAM,CAACC,OAAP,GAAiB7B,UAAjB","sourcesContent":["const { Destino } = require(\"../models\");\r\nconst middleware = {};\r\n\r\nconst validateDestinoId = async (req, res, next) => {\r\n  const destinoId = req.params.id;\r\n  const destino = await Destino.findByPk(destinoId);\r\n  if (!destino || !destino.activo) {\r\n    return res.status(404).json({ message: `El estado con id ${destinoId} no existe` });\r\n  }\r\n  next();\r\n};\r\nmiddleware.validateDestinoId = validateDestinoId;\r\n\r\nconst validarFiltroDestino = (req, res, next) => {\r\n  const { name, pais, provincia, localidad } = req.query;\r\n  const soloLetras = /^[A-Za-zÁÉÍÓÚÑáéíóúñ\\s]+$/;\r\n  for (const [campo, valor] of Object.entries({ name, pais, provincia, localidad })) {\r\n    if (valor && (!soloLetras.test(valor) || valor.length > 100)) {\r\n      return res.status(400).json({\r\n        error: `El valor del parámetro \"${campo}\" es inválido.`,\r\n      });\r\n    }\r\n  }\r\n  next();\r\n};\r\n\r\nmiddleware.validarFiltroDestino = validarFiltroDestino;\r\n\r\nmodule.exports = middleware;\r\n"],"file":"destinoMiddleware.js"}