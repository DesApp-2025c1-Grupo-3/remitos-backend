{"version":3,"sources":["../../bin/www.js"],"names":["debugPkg","require","http","app","db","redisClient","debug","server","createServer","port","get","connect","then","console","log","sequelize","authenticate","sync","alter","listen","catch","error","process","exit","on","onError","onListening","syscall","bind","code","addr","address"],"mappings":"AAAA;;AACA;;AACA;AACA;AACA;;AAEA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,OAAD,CAAxB;;AACA,MAAMC,IAAI,GAAGD,OAAO,CAAC,MAAD,CAApB;;AACA,MAAME,GAAG,GAAGF,OAAO,CAAC,YAAD,CAAnB;;AACA,MAAMG,EAAE,GAAGH,OAAO,CAAC,eAAD,CAAlB;;AACA,MAAMI,WAAW,GAAGJ,OAAO,CAAC,qBAAD,CAA3B;;AACA,MAAMK,KAAK,GAAGN,QAAQ,CAAC,eAAD,CAAtB;AAEA;AACA;AACA;;AACA,MAAMO,MAAM,GAAGL,IAAI,CAACM,YAAL,CAAkBL,GAAlB,CAAf;AAEA;AACA;AACA;;AACA,MAAMM,IAAI,GAAGN,GAAG,CAACO,GAAJ,CAAQ,MAAR,CAAb;;AACA,IAAI,CAACD,IAAL,EAAW;AACT,QAAM,qDAAN;AACD,C,CAED;;;AACAJ,WAAW,CACRM,OADH,GAEGC,IAFH,CAEQ,MAAM;AACVC,EAAAA,OAAO,CAACC,GAAR,CAAY,4BAAZ;AAEA,SAAOV,EAAE,CAACW,SAAH,CAAaC,YAAb,EAAP;AACD,CANH,EAOGJ,IAPH,CAOQ,MAAM;AACVC,EAAAA,OAAO,CAACC,GAAR,CAAY,uCAAZ;AAEA,SAAOV,EAAE,CAACW,SAAH,CAAaE,IAAb,CAAkB;AAAEC,IAAAA,KAAK,EAAE;AAAT,GAAlB,CAAP,CAHU,CAIV;AACD,CAZH,EAaGN,IAbH,CAaQ,MAAM;AACVC,EAAAA,OAAO,CAACC,GAAR,CAAY,+BAAZ;AAEAP,EAAAA,MAAM,CAACY,MAAP,CAAcV,IAAd,EAAoB,MAAM;AACxBI,IAAAA,OAAO,CAACC,GAAR,CAAa,mDAAkDL,IAAK,EAApE;AACD,GAFD;AAGD,CAnBH,EAoBGW,KApBH,CAoBUC,KAAD,IAAW;AAChBR,EAAAA,OAAO,CAACQ,KAAR,CACE,sDADF,EAEEA,KAFF;AAIAC,EAAAA,OAAO,CAACC,IAAR,CAAa,CAAb;AACD,CA1BH;AA4BAhB,MAAM,CAACiB,EAAP,CAAU,OAAV,EAAmBC,OAAnB;AACAlB,MAAM,CAACiB,EAAP,CAAU,WAAV,EAAuBE,WAAvB;AAEA;AACA;AACA;;AACA,SAASD,OAAT,CAAiBJ,KAAjB,EAAwB;AACtB,MAAIA,KAAK,CAACM,OAAN,KAAkB,QAAtB,EAAgC;AAC9B,UAAMN,KAAN;AACD;;AAED,QAAMO,IAAI,GAAG,OAAOnB,IAAP,KAAgB,QAAhB,GAA4B,QAAOA,IAAK,EAAxC,GAA6C,QAAOA,IAAK,EAAtE;;AAEA,UAAQY,KAAK,CAACQ,IAAd;AACE,SAAK,QAAL;AACEhB,MAAAA,OAAO,CAACQ,KAAR,CAAe,GAAEO,IAAK,+BAAtB;AACAN,MAAAA,OAAO,CAACC,IAAR,CAAa,CAAb;AACA;;AACF,SAAK,YAAL;AACEV,MAAAA,OAAO,CAACQ,KAAR,CAAe,GAAEO,IAAK,oBAAtB;AACAN,MAAAA,OAAO,CAACC,IAAR,CAAa,CAAb;AACA;;AACF;AACE,YAAMF,KAAN;AAVJ;AAYD;AAED;AACA;AACA;;;AACA,SAASK,WAAT,GAAuB;AACrB,QAAMI,IAAI,GAAGvB,MAAM,CAACwB,OAAP,EAAb;AACA,QAAMH,IAAI,GAAG,OAAOE,IAAP,KAAgB,QAAhB,GAA4B,QAAOA,IAAK,EAAxC,GAA6C,QAAOA,IAAI,CAACrB,IAAK,EAA3E;AACAH,EAAAA,KAAK,CAAE,gBAAesB,IAAK,EAAtB,CAAL;AACD","sourcesContent":["#!/usr/bin/env node\n/* eslint-disable no-console */\n/**\n * Module dependencies.\n */\n\nconst debugPkg = require(\"debug\");\nconst http = require(\"http\");\nconst app = require(\"../lib/app\");\nconst db = require(\"../lib/models\");\nconst redisClient = require(\"../lib/config/redis\");\nconst debug = debugPkg(\"js/www:server\");\n\n/**\n * Create HTTP server.\n */\nconst server = http.createServer(app);\n\n/**\n * Listen on the port set on the app, on all network interfaces.\n */\nconst port = app.get(\"port\");\nif (!port) {\n  throw \"¬°¬°Hay que setear el port de la aplicaci√≥n Express!!\";\n}\n\n// Run sequelize before listen\nredisClient\n  .connect()\n  .then(() => {\n    console.log(\"‚úÖ Conexi√≥n a Redis exitosa\");\n\n    return db.sequelize.authenticate();\n  })\n  .then(() => {\n    console.log(\"‚úÖ Conexi√≥n a la base de datos exitosa\");\n\n    return db.sequelize.sync({ alter: true });\n    // alter:true ajusta las tablas si hay cambios (m√°s seguro que force:true)\n  })\n  .then(() => {\n    console.log(\"üìÑ Base de datos sincronizada\");\n\n    server.listen(port, () => {\n      console.log(`¬°Aplicaci√≥n iniciada! ====> üåé http://localhost:${port}`);\n    });\n  })\n  .catch((error) => {\n    console.error(\n      \"‚ùå Error conectando o sincronizando la base de datos:\",\n      error\n    );\n    process.exit(1);\n  });\n\nserver.on(\"error\", onError);\nserver.on(\"listening\", onListening);\n\n/**\n * Event listener for HTTP server \"error\" event.\n */\nfunction onError(error) {\n  if (error.syscall !== \"listen\") {\n    throw error;\n  }\n\n  const bind = typeof port === \"string\" ? `Pipe ${port}` : `Port ${port}`;\n\n  switch (error.code) {\n    case \"EACCES\":\n      console.error(`${bind} requires elevated privileges`);\n      process.exit(1);\n      break;\n    case \"EADDRINUSE\":\n      console.error(`${bind} is already in use`);\n      process.exit(1);\n      break;\n    default:\n      throw error;\n  }\n}\n\n/**\n * Event listener for HTTP server \"listening\" event.\n */\nfunction onListening() {\n  const addr = server.address();\n  const bind = typeof addr === \"string\" ? `pipe ${addr}` : `port ${addr.port}`;\n  debug(`Listening on ${bind}`);\n}\n"],"file":"www.js"}